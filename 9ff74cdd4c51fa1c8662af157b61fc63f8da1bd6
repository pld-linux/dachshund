- partialy rewrited byt NYF.

Based on spec by David Bryant <daveb@acres.com.au>
